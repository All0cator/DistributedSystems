plugins {
    id 'java'
    id 'application'
}

repositories {
    mavenCentral()
}

dependencies {
    implementation 'org.json:json:20250107'
}

configurations.all {
    resolutionStrategy {
        force 'org.json:json:20250107' // Explicitly force this version
    }
}

sourceSets {
    main {
        java {
            srcDirs = ['src/main/java']
        }
        resources {
            srcDirs = ['src/main/resources']
        }
    }

    test {
        java {
            srcDirs = ['src/test/java']
        }
        resources {
            srcDirs = ['src/test/resources']
        }
    }
}

task printRuntimeClasspath {
    doLast {
        println sourceSets.main.runtimeClasspath.files
    }
}

// SocketsExample

task runServerSocketsExample(type: JavaExec) {
    group = 'SocketsExample'
    description = 'Runs Server'
    main = 'SocketsExample.Server'
    classpath = sourceSets.main.runtimeClasspath
}

task runClientSocketsExample(type: JavaExec) {
    group = 'SocketsExample'
    description = 'Runs Client'
    main = 'SocketsExample.Client'
    classpath = sourceSets.main.runtimeClasspath
}

// Delivery App

task runCustomerApp(type: JavaExec) {
    group = 'DeliveryApp'
    description = 'Runs CustomerApp'
    main = 'Nodes.CustomerApp'
    classpath = sourceSets.main.runtimeClasspath
}

task runManagerApp(type: JavaExec) {
    group = 'DeliveryApp'
    description = 'Runs ManagerApp'
    main = 'Nodes.ManagerApp'
    classpath = sourceSets.main.runtimeClasspath
}

task runMaster(type: JavaExec) {
    group = 'DeliveryApp'
    description = 'Runs Master'
    main = 'Nodes.Master'
    classpath = sourceSets.main.runtimeClasspath
}

task runWorker(type: JavaExec) {
    group = 'DeliveryApp'
    description = 'Runs Worker'
    main = 'Nodes.Worker'
    classpath = sourceSets.main.runtimeClasspath
}

task runReducer(type: JavaExec) {
    group = 'DeliveryApp'
    description = 'Runs Reducer'
    main = 'Nodes.Reducer'
    classpath = sourceSets.main.runtimeClasspath
}

task debugMaster(type: JavaExec) {
    group = 'Debug'
    description = 'Debugs Master'
    main = 'Nodes.Master'
    classpath = sourceSets.main.runtimeClasspath
}

task debugWorker(type: JavaExec) {
    group = 'Debug'
    description = 'Debugs Worker'
    main = 'Nodes.Worker'
    classpath = sourceSets.main.runtimeClasspath
}

task debugReducer(type: JavaExec) {
    group = 'Debug'
    description = 'Debugs Reducer'
    main = 'Nodes.Reducer'
    classpath = sourceSets.main.runtimeClasspath
}